func main() {
  var m sync.RWMutex

  go func() {
    m.RLock()
    read()
    m.RUnlock()
  }()

  go func() {
    m.RLock()
    read()
    m.RUnlock()
  }()

  m.Lock()
  write()
  m.Unlock()
}